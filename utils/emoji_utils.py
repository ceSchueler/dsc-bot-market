import random
from typing import List, Set, Dict


class EmojiManager:
    """
    Manages emoji-related functionality for the bot
    """

    NUMBER_EMOJIS: Dict[str, str] = {
        '0': '0️⃣', '1': '1️⃣', '2': '2️⃣', '3': '3️⃣', '4': '4️⃣',
        '5': '5️⃣', '6': '6️⃣', '7': '7️⃣', '8': '8️⃣', '9': '9️⃣'
    }

    def __init__(self):
        self.used_flags: Set[str] = set()
        self._load_flag_emojis()

    def _load_flag_emojis(self):
        """Loads the flag emojis from a predefined list"""
        # Load your FLAG_EMOJIS list here
        self.FLAG_EMOJIS = ['🇦🇴', '🇧🇫', '🇧🇮', '🇧🇯', '🇧🇼', '🇨🇩', '🇨🇫', '🇨🇬', '🇨🇮', '🇨🇲', '🇨🇻', '🇩🇯', '🇩🇿', '🇪🇬', '🇪🇭',
                            '🇪🇷', '🇪🇹', '🇬🇦', '🇬🇭', '🇬🇲', '🇬🇳', '🇬🇶', '🇬🇼', '🇰🇪', '🇰🇲', '🇱🇷', '🇱🇸', '🇱🇾', '🇲🇦', '🇲🇬',
                            '🇲🇱', '🇲🇷', '🇲🇺', '🇲🇼', '🇲🇿', '🇳🇦', '🇳🇪', '🇳🇬', '🇷🇼', '🇸🇨', '🇸🇩', '🇸🇱', '🇸🇳', '🇸🇴', '🇸🇸',
                            '🇸🇿', '🇹🇩', '🇹🇬', '🇹🇳', '🇹🇿', '🇺🇬', '🇿🇦', '🇿🇲', '🇿🇼', '🇦🇬', '🇦🇮', '🇦🇷', '🇦🇼', '🇧🇧', '🇧🇱',
                            '🇧🇲', '🇧🇴', '🇧🇶', '🇧🇷', '🇧🇸', '🇧🇿', '🇨🇦', '🇨🇱', '🇨🇴', '🇨🇷', '🇨🇺', '🇨🇼', '🇩🇲', '🇩🇴', '🇪🇨',
                            '🇫🇰', '🇬🇩', '🇬🇫', '🇬🇵', '🇬🇹', '🇬🇾', '🇭🇳', '🇭🇹', '🇯🇲', '🇰🇳', '🇰🇾', '🇱🇨', '🇲🇫', '🇲🇶', '🇲🇸',
                            '🇲🇽', '🇳🇮', '🇵🇦', '🇵🇪', '🇵🇲', '🇵🇷', '🇵🇾', '🇸🇷', '🇸🇻', '🇸🇽', '🇹🇨', '🇹🇹', '🇺🇸', '🇺🇾', '🇻🇪',
                            '🇻🇬', '🇻🇮', '🇦🇪', '🇦🇫', '🇦🇿', '🇧🇩', '🇧🇭', '🇧🇳', '🇧🇹', '🇨🇳',
                            '🇭🇰', '🇮🇩', '🇮🇱', '🇮🇳', '🇮🇶', '🇮🇷', '🇯🇴', '🇯🇵', '🇰🇬', '🇰🇭', '🇰🇵', '🇰🇷', '🇰🇼', '🇰🇿', '🇱🇦',
                            '🇱🇧', '🇱🇰', '🇲🇲', '🇲🇳', '🇲🇴', '🇲🇻', '🇲🇾', '🇳🇵', '🇴🇲', '🇵🇭', '🇵🇰', '🇵🇸', '🇶🇦', '🇷🇺', '🇸🇦',
                            '🇸🇬', '🇸🇾', '🇹🇭', '🇹🇯', '🇹🇱', '🇹🇲', '🇹🇷', '🇹🇼', '🇺🇿', '🇻🇳', '🇾🇪', '🇦🇩', '🇦🇱', '🇦🇲', '🇦🇹',
                            '🇧🇦', '🇧🇪', '🇧🇬', '🇧🇾', '🇨🇭', '🇨🇾', '🇨🇿', '🇩🇪', '🇩🇰', '🇪🇦', '🇪🇪', '🇪🇸', '🇪🇺', '🇫🇮', '🇫🇷',
                            '🇬🇧', '🇬🇪', '🇬🇬', '🇬🇮', '🇬🇷', '🇭🇷', '🇭🇺', '🇮🇪', '🇮🇲', '🇮🇸', '🇮🇹', '🇯🇪', '🇱🇮', '🇱🇹', '🇱🇺',
                            '🇱🇻', '🇲🇨', '🇲🇩', '🇲🇪', '🇲🇰', '🇲🇹', '🇳🇱', '🇳🇴', '🇵🇱', '🇵🇹', '🇷🇴', '🇷🇸', '🇷🇺', '🇸🇪', '🇸🇮',
                            '🇸🇰', '🇸🇲', '🇺🇦', '🇻🇦', '🇽🇰', '🏴󠁧󠁢󠁥󠁮󠁧󠁿', '🏴󠁧󠁢󠁳󠁣󠁴󠁿', '🏴󠁧󠁢󠁷󠁬󠁳󠁿', '🇦🇨', '🇦🇶', '🇦🇸', '🇦🇺',
                            '🇦🇽', '🇧🇻', '🇨🇨', '🇨🇰', '🇨🇵', '🇨🇽', '🇩🇬', '🇫🇯', '🇫🇲', '🇬🇱', '🇬🇸', '🇬🇺', '🇭🇲', '🇮🇨', '🇮🇴',
                            '🇰🇮', '🇲🇭', '🇲🇵', '🇳🇨', '🇳🇫', '🇳🇷', '🇳🇺', '🇳🇿', '🇵🇫', '🇵🇬', '🇵🇳', '🇵🇼', '🇷🇪', '🇸🇧', '🇸🇭',
                            '🇸🇯', '🇸🇹', '🇹🇦', '🇹🇫', '🇹🇰', '🇹🇴', '🇹🇻', '🇺🇲', '🇻🇨', '🇻🇺', '🇼🇫', '🇼🇸', '🇾🇹']

    def get_number_emoji(self, n: int) -> List[str]:
        """
        Converts a number to its emoji representation
        """
        s = f"{n:02}"  # Ensures leading 0
        return [self.NUMBER_EMOJIS[d] for d in s]

    def get_unique_flag(self) -> str:
        """
        Returns a unique flag emoji that hasn't been used recently
        """
        available_flags = list(set(self.FLAG_EMOJIS) - self.used_flags)

        if not available_flags:
            self.used_flags.clear()
            available_flags = self.FLAG_EMOJIS.copy()

        chosen = random.choice(available_flags)
        self.used_flags.add(chosen)
        return chosen
